<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>锂电固废环境风险评估系统</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* 基础样式 */
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            max-width: 1000px;
            margin: 30px auto;
            padding: 30px;
            background: #f8fafc;
            line-height: 1.6;
            color: var(--primary-color);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin: 40px 0;
            font-weight: 600;
            font-size: 2.4em;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        /* 字段集样式 */
        fieldset {
            margin: 25px 0;
            padding: 25px;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            background: white;
            box-shadow: var(--box-shadow);
            transition: box-shadow 0.3s ease;
        }

        fieldset:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        legend {
            font-family: 'PingFang SC', sans-serif;
            font-weight: 600;
            padding: 8px 20px;
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            border-radius: var(--border-radius);
            font-size: 1.1em;
            letter-spacing: 0.8px;
        }

        /* 污染类别标题 */
        .category-title {
            display: block;
            margin: 20px 0 15px;
            padding: 10px 15px;
            background: #f1f5f9;
            border-left: 4px solid #3b82f6;
            border-radius: 4px;
            font-weight: 600;
            color: #1e293b;
        }

        /* 污染项布局 */
        .pollution-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            margin: 15px 0;
            padding: 10px;
        }

        .pollution-group label {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background: #f8fafc;
            border-radius: 6px;
            transition: all 0.2s ease;
            border: 1px solid #e2e8f0;
        }

        .pollution-group label:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow);
            border-color: #bfdbfe;
        }

        /* 复选框样式 */
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            border: 2px solid #cbd5e1;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        input[type="checkbox"]:checked {
            background: #3b82f6;
            border-color: #3b82f6;
        }

        input[type="checkbox"]:checked::after {
            content: "✓";
            color: white;
            font-size: 12px;
            position: relative;
            left: 1px;
            top: -1px;
        }

        /* 输入框样式 */
        input[type="number"] {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            margin: 5px 0;
            width: 120px;
            transition: all 0.2s ease;
        }

        input[type="number"]:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
            outline: none;
        }

        /* 按钮样式 */
        button {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            padding: 12px 28px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            letter-spacing: 0.8px;
            transition: all 0.2s ease;
            box-shadow: var(--box-shadow);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        /* 表格样式 */
        table {
            width: 100%;
            margin: 25px 0;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            border-collapse: collapse;
        }

        th {
            background: #3b82f6;
            color: white;
            padding: 14px !important;
            font-weight: 500;
        }

        td {
            padding: 12px !important;
            border-bottom: 1px solid #f1f5f9;
        }

        tr:nth-child(even) {
            background: #f8fafc;
        }

        /* 警告信息 */
        .warning {
            background: #fee2e2;
            color: #dc2626;
            padding: 14px;
            border-radius: 6px;
            margin: 20px 0;
            border: 1px solid #fca5a5;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* 图标样式 */
        .fa-info-circle {
            color: #3b82f6;
            margin-right: 8px;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            body {
                padding: 20px;
            }

            fieldset {
                padding: 20px;
            }

            .pollution-group {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }

            button {
                width: 100%;
            }
        }

        /* 特殊区块样式 */
        .organic-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .organic-category {
            padding: 15px;
            background: #f8fafc;
            border-radius: var(--border-radius);
            border: 1px solid #e2e8f0;
        }

        /* 蓝色系渐变 (标题) */
        [style*="background:#2563eb"] {
            background: linear-gradient(to right, #7fa9f7, #4d80da) !important;
        }

        /* 浅紫色系渐变 (冷色系) */
        [style*="background:#d97706"] {
            background: linear-gradient(to right, #d1c4e9, #9570a0) !important;
        }

        /* 浅青色系渐变 (冷色系) */
        [style*="background:#dc2626"] {
            background: linear-gradient(to right, #80deea, #4db6ac) !important;
        }

        /* 浅绿色系渐变 (冷色系) */
        [style*="background:#0596a9"] {
            background: linear-gradient(to right, #a0c4aa, #70c29a) !important;
        }

        /* 浅蓝绿系渐变 (冷色系) */
        [style*="background:#dc2699"] {
            background: linear-gradient(to right, #80d6d0, #68b4f0) !important;
        }

        /* 资源展示区样式 */
        .selected-resources-container {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            transition: box-shadow 0.3s ease;
        }

        .selected-resources-container:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .resource-tag {
            display: inline-flex;
            align-items: center;
            margin: 5px;
            padding: 8px 15px;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            transition: all 0.2s ease;
            font-size: 0.95em;
        }

        .resource-tag:hover {
            transform: translateY(-2px);
            border-color: #bfdbfe;
            box-shadow: var(--box-shadow);
        }

        .remove-resource-btn {
            margin-left: 10px;
            color: #ef4444;
            cursor: pointer;
            font-weight: 600;
            transition: color 0.2s ease;
            padding-left: 8px;
            border-left: 1px solid #e2e8f0;
        }

        .remove-resource-btn:hover {
            color: #dc2626;
            text-shadow: 0 0 8px rgba(220, 38, 38, 0.2);
        }

        /* 原有样式补充 */
        .key-resource-item label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
        }

        .resource-section h4 {
            color: #1e293b;
            margin: 20px 0 15px;
            font-size: 1.1em;
            position: relative;
            padding-left: 10px;
        }

        .resource-section h4::before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 60%;
            width: 3px;
            background: var(--secondary-color);
            border-radius: 2px;
        }
    </style>
</head>
<body>
<h1>锂电固废环境风险评估系统</h1>

<!-- 环境属性 -->
<fieldset>
    <legend>环境属性 (权重40%)</legend>
    <p class="warning-note"><i class="fas fa-info-circle"></i> 选取原则：考虑待评估固废主要成分中前七位
        <span style="color: orangered; font-weight: bold;">金属</span>
        和前七位
        <span style="color: orangered; font-weight: bold;">有机物</span>
    </p>

    <!-- 金属污染物 -->
    <div class="environment-section">
        <h4 class="section-title"><i class="fas fa-radiation"></i> 金属污染物选择</h4>

        <!-- 高污染度 -->
        <div class="pollution-category high-pollution">
            <div class="category-title">高污染度（1.0）</div>
            <div class="pollution-group">
                <label><input type="checkbox" class="metal" data-score="1">钴</label>
                <label><input type="checkbox" class="metal" data-score="1">铬</label>
                <label><input type="checkbox" class="metal" data-score="1">砷</label>
                <label><input type="checkbox" class="metal" data-score="1">铑</label>
                <label><input type="checkbox" class="metal" data-score="1">铂</label>
                <label><input type="checkbox" class="metal" data-score="1">钯</label>
                <label><input type="checkbox" class="metal" data-score="1">铱</label>
                <label><input type="checkbox" class="metal" data-score="1">锇</label>
                <label><input type="checkbox" class="metal" data-score="1">汞</label>
                <label><input type="checkbox" class="metal" data-score="1">铼</label>
                <label><input type="checkbox" class="metal" data-score="1">钌</label>
                <label><input type="checkbox" class="metal" data-score="1">钪</label>
                <label><input type="checkbox" class="metal" data-score="1">银</label>
            </div>
        </div>

        <!-- 中污染度 -->
        <div class="pollution-category medium-pollution">
            <div class="category-title">中污染度（0.7）</div>
            <div class="pollution-group">
                <label><input type="checkbox" class="metal" data-score="0.7">铀</label>
                <label><input type="checkbox" class="metal" data-score="0.7">镥</label>
                <label><input type="checkbox" class="metal" data-score="0.7">碲</label>
                <label><input type="checkbox" class="metal" data-score="0.7">铥</label>
                <label><input type="checkbox" class="metal" data-score="0.7">铕</label>
                <label><input type="checkbox" class="metal" data-score="0.7">锗</label>
                <label><input type="checkbox" class="metal" data-score="0.7">钽</label>
                <label><input type="checkbox" class="metal" data-score="0.7">铽</label>
                <label><input type="checkbox" class="metal" data-score="0.7">钼</label>
                <label><input type="checkbox" class="metal" data-score="0.7">钬</label>
                <label><input type="checkbox" class="metal" data-score="0.7">铟</label>
                <label><input type="checkbox" class="metal" data-score="0.7">镓</label>
                <label><input type="checkbox" class="metal" data-score="0.7">锑</label>
                <label><input type="checkbox" class="metal" data-score="0.7">镱</label>
                <label><input type="checkbox" class="metal" data-score="0.7">镉</label>
                <label><input type="checkbox" class="metal" data-score="0.7">镍</label>
                <label><input type="checkbox" class="metal" data-score="0.7">锰</label>
            </div>
        </div>

        <!-- 低污染度 -->
        <div class="pollution-category low-pollution">
            <div class="category-title">低污染度（0.4）</div>
            <div class="pollution-group">
                <label><input type="checkbox" class="metal" data-score="0.4">铪</label>
                <label><input type="checkbox" class="metal" data-score="0.4">铜</label>
                <label><input type="checkbox" class="metal" data-score="0.4">铍</label>
                <label><input type="checkbox" class="metal" data-score="0.4">钍</label>
                <label><input type="checkbox" class="metal" data-score="0.4">钐</label>
                <label><input type="checkbox" class="metal" data-score="0.4">镝</label>
                <label><input type="checkbox" class="metal" data-score="0.4">铋</label>
                <label><input type="checkbox" class="metal" data-score="0.4">铒</label>
                <label><input type="checkbox" class="metal" data-score="0.4">钆</label>
                <label><input type="checkbox" class="metal" data-score="0.4">硒</label>
                <label><input type="checkbox" class="metal" data-score="0.4">锡</label>
                <label><input type="checkbox" class="metal" data-score="0.4">钨</label>
                <label><input type="checkbox" class="metal" data-score="0.4">钒</label>
                <label><input type="checkbox" class="metal" data-score="0.4">镨</label>
                <label><input type="checkbox" class="metal" data-score="0.4">钕</label>
                <label><input type="checkbox" class="metal" data-score="0.4">金</label>
            </div>
        </div>

        <!-- 轻微污染度 -->
        <div class="pollution-category mild-pollution">
            <div class="category-title">轻微污染度（0.1）</div>
            <div class="pollution-group">
                <label><input type="checkbox" class="metal" data-score="0.1">钇</label>
                <label><input type="checkbox" class="metal" data-score="0.1">铈</label>
                <label><input type="checkbox" class="metal" data-score="0.1">铌</label>
                <label><input type="checkbox" class="metal" data-score="0.1">镧</label>
                <label><input type="checkbox" class="metal" data-score="0.1">铝</label>
                <label><input type="checkbox" class="metal" data-score="0.1">锂</label>
                <label><input type="checkbox" class="metal" data-score="0.1">锌</label>
                <label><input type="checkbox" class="metal" data-score="0.1">钛</label>
                <label><input type="checkbox" class="metal" data-score="0.1">铅</label>
                <label><input type="checkbox" class="metal" data-score="0.1">镁</label>
                <label><input type="checkbox" class="metal" data-score="0.1">锶</label>
                <label><input type="checkbox" class="metal" data-score="0.1">铁</label>
                <label><input type="checkbox" class="metal" data-score="0.1">硼</label>
                <label><input type="checkbox" class="metal" data-score="0.1">锆</label>
                <label><input type="checkbox" class="metal" data-score="0.1">钡</label>
                <label><input type="checkbox" class="metal" data-score="0.1">铯</label>
                <label><input type="checkbox" class="metal" data-score="0.1">铷</label>
                <label><input type="checkbox" class="metal" data-score="0.1">钙</label>
            </div>
        </div>
    </div>

    <!-- 有机物污染物 -->
    <div class="environment-section">
        <h4 class="section-title"><i class="fas fa-flask"></i> 有机物污染物选择</h4>
        <div class="organic-group">
            <!-- 左侧列 -->
            <div class="organic-category">
                <div class="category-title" style="background:#2563eb;">一类管控名录中含有此有机物（0.1）</div>
                <div class="pollution-group">
                    <label><input type="checkbox" class="youjiwu" data-score="0.1">聚偏二氟乙烯(PVDF)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0.1">ABS塑料</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0.1">乙醇</label>
                </div>

                <div class="category-title" style="background:#dc2699">二类管控名录中皆含有此有机物（0.4）</div>
                <div class="pollution-group">
                    <label><input type="checkbox" class="youjiwu" data-score="0.4">N-甲基吡咯烷酮(NMP)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0.4">卡尔费休液</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0.4">碳酸二甲酯(DMC)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0.4">乙酸乙酯</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0.4">碳酸二乙酯(DEC)</label>
                </div>

                <div class="category-title" style="background:#d97706">三类管控名录中皆含有此有机物（0.7）</div>
                <div class="pollution-group">
                    <label><input type="checkbox" class="youjiwu" data-score="0.7">丁苯橡胶(SBR)</label>
                </div>
                <div class="category-title" style="background:#dc2626">四类管控名录中皆含有此有机物（1.0）</div>
                <div class="pollution-group">
                    <label><input type="checkbox" class="youjiwu" data-score="1">异氰酸酯共聚物</label>
                </div>
            </div>

            <!-- 右侧列 -->
            <div class="organic-category">
                <div class="category-title" style="background:#0596a9;">不在管控名录（0）</div>
                <div class="pollution-group">
                    <label><input type="checkbox" class="youjiwu" data-score="0">羧甲基纤维素钠(CMC)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚丙烯(PP)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚乙烯(PE)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚氯乙烯(PVC)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚苯乙烯(PS)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚碳酸酯(PC)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">乙二醇</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚醚树脂</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚氨酯</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚吡咯(PPy)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">1,4,5,8-四羟基-9,10-蒽醌(THAQ)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚四氟乙烯(PTFE)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚酯树脂</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">聚乙烯醇(PVA)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">二(2-乙基己基)磷酸酯(P204)</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">六溴联苯</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">苯环氧树脂</label>
                    <label><input type="checkbox" class="youjiwu" data-score="0">脂环氧树脂</label>
                </div>
            </div>
        </div>
    </div>

    <!-- 其他污染因子 -->
    <div class="environment-section">
        <div class="category-header" style="margin:15px 0 20px;">
            <h4 class="section-title">
                <i class="fas fa-vial"></i> <!-- 使用不同的图标以示区分 -->
                其他污染因子
            </h4>
        </div>

        <div class="pollution-group">
            <label><input type="checkbox" class="others" data-score="0.4">氟化物（0.4）</label>
            <label><input type="checkbox" class="others" data-score="0.4">含磷物（0.4）</label>
            <label><input type="checkbox" class="others" data-score="0.1">氯化物（0.1）</label>
            <label><input type="checkbox" class="others" data-score="0.1">硫化物（0.1）</label>
        </div>
    </div>
</fieldset>

<fieldset>
    <legend>生物毒性 (权重10%)</legend>

    <div>
        <p style="color: black; margin: 0;">
            说明：请选择固废中的前七位
            <span style="color: orangered; font-weight: bold;">金属离子</span>
            和
            <span style="color: orangered; font-weight: bold;">无机物</span>
            （请注意物质的形态），以及前七位
            <span style="color: orangered; font-weight: bold;">有机物</span>
            （已在"环境属性"中选择）计算生物毒性。
        </p>
    </div>

    <!-- 其他污染物区块 -->
    <div class="pollution-category" style="margin-top:20px;">
        <!-- 金属分组 -->
        <div class="pollution-category-metal">
            <div class="category-title">金属离子</div>
            <div class="pollution-group">
                <label><input type="checkbox" class="toxic" data-score="0">锂</label>
                <label><input type="checkbox" class="toxic" data-score="0">镍</label>
                <label><input type="checkbox" class="toxic" data-score="0">钴</label>
                <label><input type="checkbox" class="toxic" data-score="0">锰</label>
                <label><input type="checkbox" class="toxic" data-score="0">铁</label>
                <label><input type="checkbox" class="toxic" data-score="0">铝</label>
                <label><input type="checkbox" class="toxic" data-score="0">铜</label>
                <label><input type="checkbox" class="toxic" data-score="0">钙</label>
                <label><input type="checkbox" class="toxic" data-score="0">镁</label>
                <label><input type="checkbox" class="toxic" data-score="0">锌</label>
                <label><input type="checkbox" class="toxic" data-score="0">银</label>
                <label><input type="checkbox" class="toxic" data-score="0">金</label>
                <label><input type="checkbox" class="toxic" data-score="0">镉</label>
                <label><input type="checkbox" class="toxic" data-score="0">钽</label>
            </div>
        </div>

        <div class="pollution-category-wujiwu">
            <div class="category-title">无机物</div>
            <div class="pollution-group">
                <label><input type="checkbox" class="toxic" data-score="0">氟化铝</label>
                <label><input type="checkbox" class="toxic" data-score="0">氟化钙</label>
                <label><input type="checkbox" class="toxic" data-score="0">六氟磷酸锂</label>
                <label><input type="checkbox" class="toxic" data-score="0">硫酸钙</label>
                <label><input type="checkbox" class="toxic" data-score="0">氢氧化钙</label>
                <label><input type="checkbox" class="toxic" data-score="0">磷酸钙</label>
                <label><input type="checkbox" class="toxic" data-score="0">石墨</label>
                <label><input type="checkbox" class="toxic" data-score="0">炭黑</label>
                <label><input type="checkbox" class="toxic" data-score="0">活性炭</label>
                <label><input type="checkbox" class="toxic" data-score="0">二氧化硅</label>
                <label><input type="checkbox" class="toxic" data-score="0">碳酸钙</label>
                <label><input type="checkbox" class="toxic" data-score="0">二氧化钛</label>
                <label><input type="checkbox" class="toxic" data-score="0">氧化铝</label>
                <label><input type="checkbox" class="toxic" data-score="0">不锈钢</label>
            </div>
        </div>

    </div>
    <div>
        <p style="text-indent: 30px; font-size: 14px;">说明：污染物名称：急性毒性LD50（mg/kg）→ 分数， 生态毒性EC50（mg/kg） →
            分数</p>
        <p style="text-indent: 30px; font-size: 16px; font-weight: bold;">生物毒性计算结果：</p>
        <div id="autoToxicityList"></div>
    </div>
</fieldset>

<!-- 资源属性模块 -->
<fieldset>
    <legend>资源属性 (权重40%)</legend>

    <div>
        <p style="color: black; margin: 0;">
            说明：请填入
            <span style="color: orangered; font-weight: bold;">可回收非关键资源数量</span>
            ，其他参数自动填入。
        </p>
    </div>

    <!-- 已选资源展示区 -->
    <div class="selected-resources-container">
        <h4>已选关键资源（点击×排除）</h4>
        <div id="selectedResourcesList" class="resources-grid"></div>
    </div>
    <!-- 关键资源固定输入 -->
    <div class="resource-section">
        <h4>关键资源数量：</h4>
        <div class="key-resource-item">
            <label>一级关键资源（1.0）数量：
                <input type="number" id="level1" min="0" value="0" style="width: 80px" disabled>
            </label>
        </div>
        <div class="key-resource-item">
            <label>二级关键资源（0.7）数量：
                <input type="number" id="level2" min="0" value="0" style="width: 80px" disabled>
            </label>
        </div>
        <div class="key-resource-item">
            <label>三级关键资源（0.4）数量：
                <input type="number" id="level3" min="0" value="0" style="width: 80px" disabled>
            </label>
        </div>
        <div class="key-resource-item">
            <label>四级关键资源（0.2）数量：
                <input type="number" id="level4" min="0" value="0" style="width: 80px" disabled>
            </label>
        </div>
    </div>

    <!-- 可回收非关键资源数量 -->
    <div class="resource-section" style="margin-top:15px">
        <h4>可回收非关键资源：</h4>
        <label> 可回收非关键资源（0.1）数量
            <input type="number" id="recyclable" min="0" value="0" style="width: 80px">
        </label>
    </div>

    <!-- 复杂度计算 -->
    <div class="resource-section" style="margin-top:15px">
        <h4>资源复杂度：</h4>
        <label>关键资源总数：<input type="number" id="totalResourceTypes" min="0" value="0" disabled></label>
    </div>
</fieldset>

<!-- 排放强度 -->
<fieldset>
    <legend>排放强度 (权重10%)</legend>
    <div>
        <p style="color: black; margin: 0;">
            说明：请填入
            <span style="color: orangered; font-weight: bold;">年固废总量(吨)</span>
            和
            <span style="color: orangered; font-weight: bold;">年处理量(吨)</span>
            。
        </p>
    </div>


    <div>
        <label>年固废总量(吨):
            <input type="number" id="totalWaste" min="0" value="0">
        </label>
    </div>
    <div>
        <label>年处理量(吨):
            <input type="number" id="treatedWaste" min="0" value="0">
        </label>
    </div>
</fieldset>
<div style="display: flex; justify-content: center; gap: 20px; margin-top: 30px">
    <button onclick="calculate()">开始计算</button>
    <button onclick="clearForm()" style="background: linear-gradient(135deg, #95a5a6, #7f8c8d)">清除数据</button>
</div>
<div id="result"></div>
<div id="warning" class="warning"></div>

<script>
    // 毒性数据库（与表格数据对应）
    const toxicityDB = {
        // 金属类
        "锂": {ld50: 150, ec50: 600},
        "镍": {ld50: 800, ec50: 45},
        "钴": {ld50: 300, ec50: 300},
        "锰": {ld50: 1500, ec50: 350},
        "铁": {ld50: 100, ec50: 650},
        "铝": {ld50: 5000, ec50: 800},
        "铜": {ld50: 25, ec50: 2.5},
        "钙": {ld50: 1000, ec50: Infinity},
        "镁": {ld50: 2800, ec50: Infinity},
        "锌": {ld50: 388, ec50: 15},
        "银": {ld50: 10, ec50: 1.5},
        "金": {ld50: 58, ec50: 58},
        "镉": {ld50: 225, ec50: 0.135},
        "钽": {ld50: 3000, ec50: Infinity},

        //其他无机物
        "氟化铝": {ld50: 1800, ec50: 1200},
        "氟化钙": {ld50: 4250, ec50: 3000},
        "六氟磷酸锂": {ld50: 170, ec50: 30},
        "硫酸钙": {ld50: 2100, ec50: 1450},
        "氢氧化钙": {ld50: 100, ec50: 84},
        "磷酸钙": {ld50: 4000, ec50: 2200},
        "石墨": {ld50: Infinity, ec50: Infinity},
        "活性炭": {ld50: 10000, ec50: 5600},
        "炭黑": {ld50: Infinity, ec50: Infinity},
        "二氧化硅": {ld50: Infinity, ec50: Infinity},
        "碳酸钙": {ld50: 6450, ec50: Infinity},
        "二氧化钛": {ld50: 1387, ec50: 334},
        "氧化铝": {ld50: 5001, ec50: 114},
        "不锈钢": {ld50: Infinity, ec50: Infinity},

        // 有机物类
        "N-甲基吡咯烷酮(NMP)": {ld50: 3910, ec50: 100},
        "聚偏二氟乙烯(PVDF)": {ld50: Infinity, ec50: Infinity},
        "羧甲基纤维素钠(CMC)": {ld50: 27000, ec50: 3000},
        "丁苯橡胶(SBR)": {ld50: Infinity, ec50: 1300},
        "聚氨酯": {ld50: Infinity, ec50: 230},
        "聚吡咯(PPy)": {ld50: Infinity, ec50: 400},
        "1,4,5,8-四羟基-9,10-蒽醌(THAQ)": {ld50: 2200, ec50: 150},
        "聚四氟乙烯(PTFE)": {ld50: 2000, ec50: 2200},
        "碳酸二甲酯(DMC)": {ld50: 9000, ec50: 6000},
        "聚醚树脂": {ld50: 6000, ec50: 1300},
        "聚酯树脂": {ld50: 6000, ec50: 1400},
        "异氰酸酯共聚物": {ld50: 5800, ec50: 45},
        "乙酸乙酯": {ld50: 5620, ec50: 450},
        "聚氯乙烯(PVC)": {ld50: 238, ec50: 250},
        "ABS塑料": {ld50: 48, ec50: 300},
        "聚乙烯(PE)": {ld50: Infinity, ec50: Infinity},
        "聚丙烯(PP)": {ld50: Infinity, ec50: Infinity},
        "聚碳酸酯(PC)": {ld50: 2200, ec50: 4800},
        "聚苯乙烯(PS)": {ld50: 1800, ec50: 4400},
        "聚乙烯醇(PVA)": {ld50: 20000, ec50: 4000},
        "二(2-乙基己基)磷酸酯(P204)": {ld50: 50, ec50: 98},
        "六溴联苯": {ld50: 90, ec50: 230},
        "乙醇": {ld50: 10470, ec50: 5012},
        "卡尔费休液": {ld50: 187, ec50: 85.6},
        "碳酸二乙酯(DEC)": {ld50: 15000, ec50: 8000},
        "乙二醇": {ld50: 4000, ec50: 1200},
        "苯环氧树脂": {ld50: 900, ec50: 800},
        "脂环氧树脂": {ld50: 2300, ec50: 15},
    };

    document.addEventListener("DOMContentLoaded", function() {
        // 金属污染物选择限制
        document.querySelectorAll('.metal').forEach(checkbox => {
            checkbox.addEventListener('change', metalCheckHandler);
        });

        // 有机物污染物选择限制
        document.querySelectorAll('.youjiwu').forEach(checkbox => {
            checkbox.addEventListener('change', organicCheckHandler);
        });

        // 生物毒性
        document.querySelectorAll('.toxic').forEach(checkbox => {
            checkbox.addEventListener('change', toxicCheckHandler);
        });
    });

    // 金属选择处理函数
    function metalCheckHandler() {
        const selected = document.querySelectorAll('.metal:checked').length;
        if (this.checked && selected > 7) {
            this.checked = false;
            alert("金属污染物最多选择7种！");
        }
    }

    // 有机物选择处理函数
    function organicCheckHandler() {
        const selected = document.querySelectorAll('.youjiwu:checked').length;
        if (this.checked && selected > 7) {
            this.checked = false;
            alert("有机污染物总数不能超过7种！");
        }
    }

    // 有毒物选择处理函数
    function toxicCheckHandler() {
        const selected1 = document.querySelectorAll('.pollution-category-metal .toxic:checked').length;
        if (this.checked && selected1 > 7) {
            this.checked = false;
            alert("生物毒性-金属 总数不能超过7种！");
        }
        const selected2 = document.querySelectorAll('.pollution-category-wujiwu .toxic:checked').length;
        if (this.checked && selected2 > 7) {
            this.checked = false;
            alert("生物毒性-无机物 总数不能超过7种！");
        }
    }

    // 自动获取选中污染物的毒性数据
    function getSelectedPollutants() {
        // 获取所有选中的金属和有机物
        const selected = [];

        // 获取有机物污染物
        document.querySelectorAll('.youjiwu:checked').forEach(checkbox => {
            const organicName = checkbox.parentElement.textContent;
            selected.push(organicName);
        });

        // 获取其他污染物
        document.querySelectorAll('.toxic:checked').forEach(checkbox => {
            const OtherName = checkbox.parentElement.textContent;
            selected.push(OtherName);
        });

        return selected;  // 添加这行返回收集的污染物数组
    }

    // 生物毒性计算函数
    function calculateToxicity() {
        let toxicForm = ``

        const pollutants = getSelectedPollutants();
        let totalBioScore = 0;
        let displayHTML = "<ul>";
        pollutants.length > 0 ? displayHTML += `` : displayHTML += `<li>生物毒性：无</li>`;
        pollutants.forEach(name => {
            const data = toxicityDB[name] || {ld50: 'ignor', ec50: 'ignor'};
            const ldScore = calculateSingleToxicity(data.ld50, 'ld50');
            const ecScore = calculateSingleToxicity(data.ec50, 'ec50');

            if (data.ld50 === 'ignor' && data.ec50 === 'ignor') {
                // 不在清单中情况不做处理
            } else {
                // 累计得分
                totalBioScore += (ldScore + ecScore);
                // 生成显示内容
                const ld50Str = data.ld50 === Infinity ? "无毒" : data.ld50;
                const ec50Str = data.ec50 === Infinity ? "无毒" : data.ec50
                displayHTML += `
                <li>${name}：
                    <span style="color: mediumblue;">LD50</span>: ${ld50Str} → ${ldScore.toFixed(3)}， 
                    <span style="color: mediumblue;">EC50</span>: ${ec50Str} → ${ecScore.toFixed(3)}
                </li>`;
            }

        });
        displayHTML += "</ul>";
        document.getElementById('autoToxicityList').innerHTML = displayHTML;

        // 拼装详情信息
        let formData1 = ``;
        let formData2 = ``;
        let count = 0;
        pollutants.forEach(name => {
            count++;
            const data = toxicityDB[name] || {ld50: 'ignor', ec50: 'ignor'};
            const ldScore = calculateSingleToxicity(data.ld50, 'ld50');
            const ecScore = calculateSingleToxicity(data.ec50, 'ec50');

            if (count === 1) {
                formData1 += `<td rowspan="${pollutants.length}">急性毒性</td><td>${name}</td><td>${data.ld50 === Infinity || data.ld50 === 'ignor' ? 0 : ldScore.toFixed(3)}</td>
                                <td rowspan="${pollutants.length * 2}">${(totalBioScore).toFixed(3)}</td>
                                <td rowspan="${pollutants.length * 2}">${(totalBioScore / 14).toFixed(3)}</td>
                                <td rowspan="${pollutants.length * 2}">10%</td>
                                <td rowspan="${pollutants.length * 2}">${(totalBioScore / 14 * 0.1).toFixed(3)}</td>
                                </tr>`;
                formData2 += `<td rowspan="${pollutants.length}">生态毒性</td><td>${name}</td><td>${data.ec50 === Infinity || data.ec50 === 'ignor' ? 0 : ecScore.toFixed(3)}</td></tr>`;
            } else {
                formData1 += `<tr><td>${name}</td><td>${data.ld50 === Infinity || data.ld50 === 'ignor'  ? 0 : ldScore.toFixed(3)}</td></tr>`;
                formData2 += `<tr><td>${name}</td><td>${data.ec50 === Infinity || data.ec50 === 'ignor'  ? 0 : ecScore.toFixed(3)}</td></tr>`;
            }
        });
        if (pollutants.length > 0) {
            toxicForm += `<tr><td rowspan="${(pollutants.length) * 2}">生物毒性</td>`;
            toxicForm += (formData1 + formData2);
        }

        return {
            totalBioScore: totalBioScore,
            toxicForm: toxicForm,
        };
    }

    function calculateSingleToxicity(value, type) {
        if (value === Infinity) return 0; // 无毒情况处理

        if (type === 'ld50') {
            if (value < 50) return 0.7;
            else if (value <= 2000) return 0.7 - (value - 50) * (0.7 - 0.4) / (2000 - 50);
            else if (value <= 5000) return 0.4 - (value - 2000) * (0.4 - 0.1) / (5000 - 2000);
            else return 0.1;
        } else if (type === 'ec50') {
            if (value <= 50) return 0.7;
            else if (value <= 500) return 0.7 - (value - 50) * (0.7 - 0.4) / (500 - 50);
            else if (value <= 2000) return 0.4 - (value - 500) * (0.4 - 0.1) / (2000 - 500);
            else return 0.1;
        }
        return 0;
    }

    const keyResourceMap = {
        // 一级关键资源（铂族金属、钴等）
        "铂": 1,
        "铱": 1,
        "锇": 1,
        "铑": 1,
        "钌": 1,
        "钯": 1,
        "钴": 1,
        "铌": 1,

        // 二级关键资源（锗、锆等）
        "锗": 2,
        "锆": 2,
        "硒": 2,
        "铬": 2,

        // 三级关键资源（锂、镍等） 
        "锂": 3,
        "镍": 3,
        "硼": 3,
        "锰": 3,
        "镁": 3,
        "钽": 3,
        "铼": 3,
        "铯": 3,
        "镓": 3,
        "铍": 3,
        "钪": 3,
        "钇": 3,
        "镧": 3,
        "铈": 3,
        "镨": 3,
        "钕": 3,
        "钷": 3,
        "钐": 3,
        "铕": 3,
        "钆": 3,
        "铽": 3,
        "镝": 3,
        "钬": 3,
        "铒": 3,
        "铥": 3,
        "镱": 3,
        "镥": 3,
        "锡": 3,
        "钼": 3,
        "钨": 3,
        "铷": 3,
        "钒": 3,

        // 四级关键资源（汞、砷等）
        "汞": 4,
        "砷": 4,
        "硫化物": 4,
        "锶": 4,
        "铅": 4,
        "镉": 4,
        "铋": 4,
        "铝": 4,
        "铁": 4,
        "锑": 4,
        "含磷物": 4,
        "锌": 4,
        "铟": 4,
        "钛": 4,
        "碲": 4,
        "金": 4,
        "铜": 4,
        "二氧化硅": 4,
        "钡": 4,
        "钙": 4
    };
    // 声明变量存储已选资源和排除资源
    let selectedResources = [];
    let excludedResources = [];
    function updateKeyResources() {
        // 初始化各等级计数器
        selectedResources = [];
        excludedResources = [];

        // 获取所有选中的金属污染物
        document.querySelectorAll('.metal:checked').forEach(checkbox => {
            const metal = checkbox.parentElement.textContent.trim().replace(/（.*?）/g, ""); // 去除括号内容
            selectedResources.push(metal);
        });

        // 捕获硫化物和含磷物（其他污染因子）
        document.querySelectorAll('.others:checked').forEach(checkbox => {
            const text = checkbox.parentElement.textContent.trim();
            const name = text.replace(/（.*?）/g, "").trim(); // 提取污染物名称
            if (name === "硫化物" || name === "含磷物") {
                selectedResources.push(name);
            }
        });

        // 捕获二氧化硅（生物毒性-无机物）
        document.querySelectorAll('.toxic:checked').forEach(checkbox => {
            const text = checkbox.parentElement.textContent.trim();
            if (text === "二氧化硅") {
                selectedResources.push(text);
            }
        });

        // 更新显示已选资源
        updateSelectedResourcesDisplay();
        calculateResource();
    }
    // 更新已选资源显示
    function updateSelectedResourcesDisplay() {
        const container = document.getElementById('selectedResourcesList');
        container.innerHTML = selectedResources.map(resource => `
        <div class="resource-tag">
            ${resource}
            <span class="remove-resource-btn" onclick="excludeResource('${resource}')">×</span>
        </div>
    `).join('');
    }

    // 排除资源函数
    function excludeResource(resource) {
        excludedResources.push(resource);
        selectedResources = selectedResources.filter(r => r !== resource);
        updateSelectedResourcesDisplay();
        calculateResource();
    }

    // 为所有金属复选框添加事件监听
    function initMetalEvents() {
        document.getElementById("warning").style.visibility = "hidden";
        document.querySelectorAll('.metal').forEach(checkbox => {
            checkbox.addEventListener('change', updateKeyResources);
        });
        // 捕获硫化物和含磷物（其他污染因子）
        document.querySelectorAll('.others').forEach(checkbox => {
            checkbox.addEventListener('change', updateKeyResources);
        });
        // 捕获二氧化硅（生物毒性-无机物）
        document.querySelectorAll('.toxic').forEach(checkbox => {
            checkbox.addEventListener('change', updateKeyResources);
        });
    }

    // 添加选择变化监听（当用户选择污染物时自动更新显示）
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', () => {
            calculateToxicity(); // 实时更新显示
        });
    });

    // 初始化时计算一次
    calculateToxicity();

    // 资源属性计算函数
    function calculateResource() {
        const counters = {1: 0, 2: 0, 3: 0, 4: 0};

        // 各等级资源得分系数
        const levelScores = {
            1: 1,    // 一级
            2: 0.7,  // 二级
            3: 0.4,  // 三级
            4: 0.2   // 四级
        };

        let totalScore = 0;
        let totalTypes = 0;
        // 计算时过滤排除资源
        selectedResources.filter(r => !excludedResources.includes(r)).forEach(metal => {
            const level = keyResourceMap[metal];
            if (level) counters[level]++;
        });
        // 计算关键资源得分
        [1, 2, 3, 4].forEach(level => {
            const count = parseInt(document.getElementById(`level${level}`).value) || 0;
            totalScore += levelScores[level] * count;
            if (count > 0) totalTypes += count;
        });

        // 更新输入框值
        [1, 2, 3, 4].forEach(level => {
            document.getElementById(`level${level}`).value = counters[level];
        });

        // 可回收非关键资源得分
        const isNonKeyScore = parseInt(document.getElementById('recyclable').value)

        // 计算复杂度
        const complexity =
            totalTypes > 4 ? 1 :
                totalTypes > 2 ? 0.7 :
                    totalTypes >= 1 ? 0.1 : 0;

        // 更新总种类数显示
        document.getElementById('totalResourceTypes').value = totalTypes;

        // 综合计算（关键资源得分 + 非关键资源得分）* 复杂度系数
        return {
            total: totalScore + complexity + (isNonKeyScore > 0 ? 0.1 * isNonKeyScore : 0),
            details: {
                level1: counters[1],
                level2: counters[2],
                level3: counters[3],
                level4: counters[4],
                complexity: complexity,
                keyScore: totalScore,
                isNonKeyScore: isNonKeyScore
            }
        };
    }

    // 初始化时绑定事件
    document.querySelectorAll('.metal').forEach(checkbox => {
        checkbox.addEventListener('change', () => {
            updateKeyResources();
            calculateResource();
        });
    });

    // 主计算函数
    function calculate() {

        // 环境属性计算
        let envScore = 0;

        let countMetal = document.querySelectorAll('.metal:checked').length;
        console.log(countMetal+"金属")
        let countYoujiwu = document.querySelectorAll('.youjiwu:checked').length;
        console.log(countYoujiwu+"有机物")
        let countOthers = document.querySelectorAll('.others:checked').length;
        console.log(countOthers+"其他")
        let ttl1 = countMetal + countYoujiwu + countOthers;

        // 金属污染得分
        let metalScore = 0;
        document.querySelectorAll('.metal:checked').forEach(checkbox => {
            envScore += parseFloat(checkbox.dataset.score);
            metalScore += parseFloat(checkbox.dataset.score);
        });
        let checkedCheckboxes = document.querySelectorAll('.metal:checked');

        // 有机物污染得分
        let ttlYoujiwu = 0;
        document.querySelectorAll('.youjiwu:checked').forEach(checkbox => {
            envScore += parseFloat(checkbox.dataset.score);
            ttlYoujiwu += parseFloat(checkbox.dataset.score);
        });
        let youjiwuNodeListOf = document.querySelectorAll('.youjiwu:checked');

        // 其他污染因子
        let ttlOthers = 0;
        document.querySelectorAll('.others:checked').forEach(checkbox => {
            envScore += parseFloat(checkbox.dataset.score);
            ttlOthers += parseFloat(checkbox.dataset.score);
        });
        let othersNodeListOf = document.querySelectorAll('.others:checked');

        let forms = ``;
        for (let i = 0; i < checkedCheckboxes.length; i++) {
            if (i === 0) {
                let check1 = checkedCheckboxes[0]
                forms += `<tr><td rowspan="${ttl1}">环境属性</td>
                            <td rowspan="${countMetal}">金属污染因子</td>
                            <td>${check1.parentElement.textContent}</td>
                            <td>${check1.dataset.score}</td>
                            <td rowspan="${countMetal}">${(metalScore).toFixed(1)}</td>
                            <td rowspan="${ttl1}">${(envScore/15).toFixed(3)}</td>
                            <td rowspan="${ttl1}">40%</td>
                            <td rowspan="${ttl1}">${(envScore*0.4/15).toFixed(3)}</td></tr>`;
            } else {
                forms += `<tr><td>${checkedCheckboxes[i].parentElement.textContent}</td>
                            <td>${checkedCheckboxes[i].dataset.score}</td>
                            </tr>`;
            }
        }

        youjiwuNodeListOf.length > 0 ? forms += `<tr>` : forms += '';
        for (let i = 0; i < youjiwuNodeListOf.length; i++) {
            if (i === 0) {
                let check1 = youjiwuNodeListOf[0]
                forms += `<td rowspan="${countYoujiwu}">有机污染物因子</td>
                            <td>${check1.parentElement.textContent}</td>
                            <td>${check1.dataset.score}</td>
                            <td rowspan="${countYoujiwu}">${(ttlYoujiwu).toFixed(3)}</td>
                            </tr>`;
            } else {
                forms += `<tr><td>${youjiwuNodeListOf[i].parentElement.textContent}</td>
                            <td>${youjiwuNodeListOf[i].dataset.score}</td>
                            </tr>`;
            }
        }

        othersNodeListOf.length > 0 ? forms += `<tr>` : forms += '';
        for (let i = 0; i < othersNodeListOf.length; i++) {
            if (i === 0) {
                let check1 = othersNodeListOf[0]
                forms += `<td rowspan="${countOthers}">其他污染因子</td>
                            <td>${check1.parentElement.textContent}</td>
                            <td>${check1.dataset.score}</td>
                            <td rowspan="${countOthers}">${(ttlOthers).toFixed(3)}</td>
                            </tr>`;
            } else {
                forms += `<tr><td>${othersNodeListOf[i].parentElement.textContent}</td>
                            <td>${othersNodeListOf[i].dataset.score}</td>
                            </tr>`;
            }
        }

        // 生物毒性计算
        const bioScore = calculateToxicity().totalBioScore; // 自动计算

        // 资源属性计算
        const resourceResult = calculateResource();
        const totalResource = resourceResult.total;
        let resourceForm = ``;
        const level1 = resourceResult.details.level1;
        const level2 = resourceResult.details.level2;
        const level3 = resourceResult.details.level3;
        const level4 = resourceResult.details.level4;
        const isNonKeyScore = resourceResult.details.isNonKeyScore;
        const keyScore = resourceResult.details.keyScore;
        const complexity = resourceResult.details.complexity;
        if(level1!==0 || level2!==0 || level3!==0 || level4!==0 || isNonKeyScore!==0 || keyScore!==0) {
            resourceForm =  `<tr></tr><td rowspan="6">资源属性</td><td rowspan="5">资源关键性</td><td>一级（1.0）</td><td>${level1}</td><td rowspan="6">${(totalResource).toFixed(1)}</td><td rowspan="6">${(totalResource/8.4).toFixed(3)}</td><td rowspan="6">40%</td><td rowspan="6">${(totalResource/8.4*0.4).toFixed(3)}</td></tr>
            <tr><td>二级（0.7）</td><td>${level2}</td></tr>
            <tr><td>三级（0.4）</td><td>${level3}</td></tr>
            <tr><td>四级（0.2）</td><td>${level4}</td></tr>
            <tr><td>可回收非关键资源(0.1)</td><td>${isNonKeyScore}</td></tr>
            <tr><td colspan="2">关键资源复杂度</td><td>${complexity}</td></tr>
             `
        }


        // 排放强度计算
        const total = parseFloat(document.getElementById('totalWaste').value);
        const treated = parseFloat(document.getElementById('treatedWaste').value);
        const untreatedRatio = ((total - treated) / total) * 100 || 0;

        let emissionScore;
        if (untreatedRatio > 50) emissionScore = 0.7;
        else if (untreatedRatio >= 20) emissionScore = 0.7 - (0.3 * (50 - untreatedRatio) / 30);
        else if (untreatedRatio >= 5) emissionScore = 0.4 - (0.3 * (20 - untreatedRatio) / 15);
        else if (untreatedRatio === 0) emissionScore = 0;
        else emissionScore = 0.1;
        let untreatedRatioForm = ``
        if (untreatedRatio !== 0) {
            untreatedRatioForm = `<tr><td>排放强度</td><td>未处理资源的比例</td><td>${untreatedRatio.toFixed(1)}%</td><td>${emissionScore.toFixed(3)}</td><td>${emissionScore.toFixed(3)}</td><td>${(emissionScore).toFixed(3)}</td><td>10%</td><td>${(emissionScore * 0.1).toFixed(3)}</td>`;
        }

        // 综合计算
        const totalScore =
            10 * ((envScore / 15 * 0.4) +      // 环境属性标准化到0-0.4
                (bioScore / 14 * 0.1) +
                (totalResource / 8.4 * 0.4) +
                (emissionScore * 0.1));

        // 显示结果
        const resultHTML = `
            <h3>评估结果</h3>
            <table>
                <tr><th>评估指标</th><th>得分</th><th>权重</th><th>加权得分</th></tr>
                <tr><td>环境属性</td><td>${(envScore / 15).toFixed(3)}</td><td>40%</td><td>${(envScore / 15 * 0.4).toFixed(3)}</td></tr>
                <tr><td>生物毒性</td><td>${(bioScore / 14).toFixed(3)}</td><td>10%</td><td>${(bioScore /14 * 0.1).toFixed(3)}</td></tr>
                <tr><td>资源属性</td><td>${(totalResource / 8.4).toFixed(3)}</td><td>40%</td><td>${(totalResource /8.4 * 0.4).toFixed(3)}</td></tr>
                <tr><td>排放强度</td><td>${emissionScore.toFixed(3)}</td><td>10%</td><td>${(emissionScore * 0.1).toFixed(3)}</td></tr>
                <tr style="font-weight:bold">
                    <td colspan="3">综合环境风险得分</td>
                    <td>${totalScore.toFixed(3)}</td>
                </tr>
            </table>
            `;
        const resultDetail = `
            <h3>详细结果</h3>
            <table>
                <tr><th>一级评估指标</th><th>二级指标</th><th>具体参数</th><th>赋分</th><th>小计</th><th>归一化</th><th>权重</th><th>加权得分</th></tr>
                ${forms}${calculateToxicity().toxicForm}${resourceForm}${untreatedRatioForm}
                <tr style="font-weight:bold">
                    <td colspan="7">综合环境风险得分</td>
                    <td>${totalScore.toFixed(3)}</td>
                </tr>
            </table>
            `
        document.getElementById('result').innerHTML = untreatedRatio < 0 ? "" : resultHTML + resultDetail;
        if (untreatedRatio < 0) {
            document.getElementById('warning').textContent = "警告：【排放强度】处理量不能超过固废总量！";
            document.getElementById("warning").style.visibility = "visible";
        } else {
            document.getElementById("warning").style.visibility = "hidden";
        }
    }

    // 清除表单函数
    function clearForm() {
        // 清除所有输入框
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.value = 0;
        });

        // 清除所有复选框
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.checked = false;
        });

        // 清除计算结果
        document.getElementById('result').innerHTML = '';
        document.getElementById('warning').textContent = '';
        document.getElementById('autoToxicityList').innerHTML = '';

        // 重置资源类型计数
        updateKeyResources();
        calculateToxicity();
        // 清除报错
        document.getElementById("warning").style.visibility = "hidden";
    }

    // 初始化页面
    initMetalEvents();

</script>
</body>
</html>